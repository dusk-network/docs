---
title: Hashing Algorithms
description: Learn about the hashing algorithms used by Dusk
---

This is an overview of the hashing algorithms used in Dusk.

## [Blake3](https://en.wikipedia.org/wiki/BLAKE_(hash_function)#BLAKE3)

- [Contract Bytecode Hash](https://github.com/dusk-network/rusk/blob/9e291c8bcfb4797c42440a3f9cb4969cad23bc42/vm/src/execute.rs#L190): The bytecode hash of a contract is the Blake3 hash of its bytecode. Before a contract is deployed, a check is made to verify that the stored bytecode hash of the contract to be deployed is correct.
- [Stored Circuit IDs](https://github.com/dusk-network/rusk/blob/9e291c8bcfb4797c42440a3f9cb4969cad23bc42/rusk-profile/src/circuit.rs#L338): When a node starts, it recovers its state and keys from disk. To identify the on-disk file that a circuit is
stored in, a Blake3 hash of the circuits and their plonk version is used.
- [Hash Wallet Passwords](https://github.com/dusk-network/rusk/blob/9e291c8bcfb4797c42440a3f9cb4969cad23bc42/rusk-wallet/src/bin/io/prompt.rs#L132): The wallet password is used to encrypt the contents of the wallet file, but before the encryption
is done, the password is first hashed depending on the format of the wallet file.
There are currently three file formats used for the wallet file. In the newest version, the Rusk Binary File Format,
SHA256 is used to hash the wallet password before use. In older versions, Blake3 is used instead.
- [Contract Events Bloom Filter](https://github.com/dusk-network/rusk/blob/4ed14f517e0cab2ab1e1e8fe1deb13ca29b8dbe3/rusk/src/lib/bloom.rs#L139): Bloom filters are used to represent events emitted by contracts. Blake3 is the algorithm
used for hashing the events internally.

## [Blake2b](https://en.wikipedia.org/wiki/BLAKE_(hash_function)#BLAKE2)

- [Contract ID Derivation](https://github.com/dusk-network/rusk/blob/9e291c8bcfb4797c42440a3f9cb4969cad23bc42/vm/src/execute.rs#L211): the contract ID of a smart contract is generated by hashing the contract bytecode, a unique nonce, and the contract
owner with Blake2b.
- [Hash Host Function](https://github.com/dusk-network/rusk/blob/9e291c8bcfb4797c42440a3f9cb4969cad23bc42/vm/src/host_queries.rs#L48): The host function `hash` uses Blake2b to hash the given bytes and converts the output to a BLS scalar.
- Transaction ID: The [ID of a transaction](https://github.com/dusk-network/rusk/blob/8d64e7e63a81ddd7fbe5f92b798d94ddbe46346c/node-data/src/ledger/transaction.rs#L81), 
[shielded](https://github.com/dusk-network/rusk/blob/8d64e7e63a81ddd7fbe5f92b798d94ddbe46346c/core/src/transfer/phoenix.rs#L535) 
and [public](https://github.com/dusk-network/rusk/blob/8d64e7e63a81ddd7fbe5f92b798d94ddbe46346c/core/src/transfer/moonlight.rs#L330), 
are derived from a Blake2b hash of its data which is converted to a BLS scalar.
- Hash Shielded Transaction Payloads: A shielded transaction payload is [hashed](https://github.com/dusk-network/rusk/blob/8d64e7e63a81ddd7fbe5f92b798d94ddbe46346c/core/src/transfer/phoenix.rs#L759) using Blake2b and coverted to a BLS scalar.
The scalar is then [used as an input](https://github.com/dusk-network/rusk/blob/8d64e7e63a81ddd7fbe5f92b798d94ddbe46346c/core/src/transfer/phoenix.rs#L556) to the circuit for verifying shielded transactions.
- [Hash Shielded Withdrawal](https://github.com/dusk-network/rusk/blob/8d64e7e63a81ddd7fbe5f92b798d94ddbe46346c/core/src/transfer/withdraw.rs#L52): To create a signature for a shielded withdrawal, a Blake2b hash of the
withdrawal data coverted to a BLS scalar is signed with the receiver's secret key.

## [SHA256](https://en.wikipedia.org/wiki/SHA-2)

- [Hash Wallet Passwords](https://github.com/dusk-network/rusk/blob/9e291c8bcfb4797c42440a3f9cb4969cad23bc42/rusk-wallet/src/bin/io/prompt.rs#L132): See the equivalent entry under Blake3.
- [Hash Consensus Keys Passwords](https://github.com/dusk-network/rusk/blob/748edcd5e9e16caffa15c02b3c6f3f4885a026dc/node-data/src/bls.rs#L156): To decrypt the consensus keys in its AES256-encypted file, a password is used. This password
is first hashed using SHA256.
- [CRS Integrity Check](https://github.com/dusk-network/rusk/blob/748edcd5e9e16caffa15c02b3c6f3f4885a026dc/rusk-profile/src/lib.rs#L180): To verify the integrity of the Common Reference String (CRS).
- [Wallet Secret Key Derivation](https://github.com/dusk-network/rusk/blob/748edcd5e9e16caffa15c02b3c6f3f4885a026dc/wallet-core/src/keys.rs#L108): Secret keys are created using a seeded random number generator. The seed used is the SHA256 hash of the wallet seed, the wallet profile index and a fixed termination string whose value depends on the whether the secret key is for a public or
shielded transaction.

## [SHA3-256](https://en.wikipedia.org/wiki/SHA-3)

- [Committee Creation for Consensus](https://github.com/dusk-network/rusk/blob/748edcd5e9e16caffa15c02b3c6f3f4885a026dc/consensus/src/user/sortition.rs#L72): In the consensus protocol, [committees are created](https://github.com/dusk-network/rusk/blob/748edcd5e9e16caffa15c02b3c6f3f4885a026dc/consensus/src/user/provisioners.rs#L193) using an algorithm called
deterministic sortition. First, a score is computed and, based on that score, eligible provisioners are selected.
The score is computed using an SHA3-256 hash of some parameters of the consensus round.
- [Block Hash Computation](https://github.com/dusk-network/rusk/blob/748edcd5e9e16caffa15c02b3c6f3f4885a026dc/node-data/src/ledger/block.rs#L43): SHA3-256 is used to compute the hash of a block.
- [Merkle Roots](https://github.com/dusk-network/rusk/blob/cbb3f728d43c0e79e02ebd27757cbaf36f64b3cd/consensus/src/proposal/block_generator.rs#L51): The merkle roots of the faults and transactions in a block are recorded in the block header for
validation. Before their merkle roots are derived, all block [transactions](https://github.com/dusk-network/rusk/blob/8d64e7e63a81ddd7fbe5f92b798d94ddbe46346c/node-data/src/ledger/transaction.rs#L67) 
and [faults](https://github.com/dusk-network/rusk/blob/8d64e7e63a81ddd7fbe5f92b798d94ddbe46346c/node-data/src/ledger/faults.rs#L91) are first hashed with SHA3-256.
- [Block Fault IDs](https://github.com/dusk-network/rusk/blob/8d64e7e63a81ddd7fbe5f92b798d94ddbe46346c/node-data/src/ledger/faults.rs#L86): The ID of a block fault is its SHA3-256 hash.
